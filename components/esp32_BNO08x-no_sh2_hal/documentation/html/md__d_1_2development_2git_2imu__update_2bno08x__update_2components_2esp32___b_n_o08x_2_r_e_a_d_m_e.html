<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>esp32_BNO08x: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">esp32_BNO08x<span id="projectnumber">&#160;1.2</span>
   </div>
   <div id="projectbrief">C++ BNO08x IMU driver component for esp-idf.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__d_1_2development_2git_2imu__update_2bno08x__update_2components_2esp32___b_n_o08x_2_r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Table of Contents.</p>
<p><a class="anchor" id="readme-top"></a> <img src="README_images/esp32_BNO08x_banner.png" alt="image" class="inline"/></p>
<ol>
<li>
<a href="#about">About</a>  </li>
<li>
<a href="#getting-started">Getting Started</a> <ul>
<li>
<a href="#wiring">Wiring</a> </li>
<li>
<a href="#adding-to-project">Adding to Project</a> </li>
<li>
<a href="#menuconfig">Menuconfig</a> </li>
<li>
<a href="#examples">Examples</a> </li>
</ul>
</li>
<li>
<a href="#unit-tests">Unit Tests</a> <ul>
<li>
<a href="#running-tests">Running Tests</a> </li>
<li>
<a href="#adding-tests">Adding Tests</a> </li>
</ul>
</li>
<li>
<a href="#documentation">Documentation</a> </li>
<li>
<a href="#program-flowcharts">Program Flowcharts</a> </li>
<li>
<a href="#acknowledgements">Acknowledgements</a> </li>
<li>
<a href="#license">License</a> </li>
<li>
<a href="#contact">Contact</a> </li>
</ol>
<h2><a class="anchor" id="autotoc_md0"></a>
About</h2>
<p>esp32_BNO08x is a C++ component for esp-idf v5.x, serving as a driver for both BNO080 and BNO085 IMUs. <br  />
</p>
<p>Originally based on the SparkFun BNO080 Arduino Library, it has since diverged significantly in implementation while retaining all original features and more, including callback functions enabled by its multi-tasked approach.</p>
<p>Currently, only SPI is supported. There are no plans to support I2C due to unpredictable behavior caused by an esp32 I2C driver silicon bug. UART support may be implemented in the future.</p>
<h2><a class="anchor" id="autotoc_md1"></a>
Getting Started</h2>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md2"></a>
Wiring</h3>
<p>The default wiring is depicted below, it can be changed at driver initialization (see example section). <br  />
</p>
<p>If your ESP does not have the GPIO pin numbers depicted below, you <b>must change the default GPIO settings in menuconfig</b>. See the Menuconfig section.</p>
<p align="right"><img src="README_images/esp32_BNO08x_wiring.png" alt="image" class="inline"/> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md3"></a>
Adding to Project</h3>
<ol type="1">
<li><p class="startli">Create a "components" directory in the root workspace directory of your esp-idf project if it does not exist already. <br  />
</p>
<p class="startli">In workspace directory: <br  />
 </p><div class="fragment"><div class="line">mkdir components</div>
</div><!-- fragment --></li>
<li><p class="startli">Cd into the components directory and clone the esp32_BNO08x repo.</p>
<div class="fragment"><div class="line">cd components</div>
<div class="line">git clone https://github.com/myles-parfeniuk/esp32_BNO08x.git</div>
</div><!-- fragment --></li>
<li>Ensure you clean your esp-idf project before rebuilding. <br  />
 Within esp-idf enabled terminal: <div class="fragment"><div class="line">idf.py fullclean</div>
</div><!-- fragment --> </li>
</ol>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md4"></a>
Menuconfig</h3>
<p>This library provides a menuconfig menu configured in Kconfig.projbuild. It contains settings to control the default GPIO and a few other things. <br  />
</p>
<p>To access the menu:</p>
<ol type="1">
<li>Within esp-idf enabled terminal, execute the menuconfig command: <div class="fragment"><div class="line">idf.py menuconfig</div>
</div><!-- fragment --></li>
<li>Scroll down to the esp_BNO08x menu and enter it, if you're using vsCode you may have to use the "j" and "k" keys instead of the arrow keys. <img src="README_images/esp32_BNO08x_menuconfig_1.png" alt="image" class="inline"/></li>
<li>Modify whatever settings you'd like from the sub menus. The GPIO Configuration menu allows for the default GPIO pins to be modified, the SPI Configuration menu allows for the default host peripheral, SCLK frequency, and queue size to be modified, the Logging menu allows for the enabling and disabling of log/print statements, and the Callbacks menu allows for the default size of the call-back execution task to be modified. <img src="README_images/esp32_BNO08x_menuconfig_2.png" alt="image" class="inline"/> </li>
</ol>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md5"></a>
Examples</h3>
<p>There are two ways data returned from the <a class="el" href="class_b_n_o08x.html" title="BNO08x IMU driver class.">BNO08x</a> can be accessed with this library:</p>
<ol type="1">
<li><b>Polling Method with</b> <code>data_available()</code> <b>Function</b>:<ul>
<li>Use the <code>data_available()</code> function to poll for new data, similar to the SparkFun library.</li>
<li>Behavior: It is a blocking function that returns <code>true</code> when new data is received or <code>false</code> if a timeout occurs.</li>
<li>See the <b>Polling Example</b> below.</li>
</ul>
</li>
<li><b>Callback Registration with</b> <code><a class="el" href="_callback_tests_8cpp.html#a6df8508e34beaeb28f34554ce0e20573">register_cb()</a></code> <b>Function</b>:<ul>
<li>Register callback functions that automatically execute upon receiving new data.</li>
<li>Behavior: The registered callback will be invoked whenever new data is available.</li>
<li>See the <b>Call-Back Function Example</b> below.</li>
</ul>
</li>
</ol>
<h4><a class="anchor" id="autotoc_md6"></a>
Polling Example</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_b_n_o08x_8hpp.html">BNO08x.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> app_main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="class_b_n_o08x.html">BNO08x</a> <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>; <span class="comment">//create IMU object with default wiring scheme</span></div>
<div class="line">    <span class="keywordtype">float</span> x, y, z = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//if a custom wiring scheme is desired instead of default:</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">    bno08x_config_t imu_config;     //create config struct</span></div>
<div class="line"><span class="comment">    imu_config.io_mosi = GPIO_NUM_X; //assign pin</span></div>
<div class="line"><span class="comment">    imu_config.io_miso = GPIO_NUM_X; //assign pin</span></div>
<div class="line"><span class="comment">    //etc...</span></div>
<div class="line"><span class="comment">    BNO08x imu(imu_config); //pass config to BNO08x constructor</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#aea8e2c6dd7a2c9899479a7f39fe94798">initialize</a>();  <span class="comment">//initialize IMU</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">//enable gyro &amp; game rotation vector</span></div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#abe04c38b5bd52d331bd8aefae1f51947">enable_game_rotation_vector</a>(100000UL); <span class="comment">//100,000us == 100ms report interval</span></div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.enable_gyro(150000UL); <span class="comment">//150,000us == 150ms report interval </span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span>(1)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//print absolute heading in degrees and angular velocity in Rad/s</span></div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#ab56b185d6c9e972a2b28c2621387bb86">data_available</a>())</div>
<div class="line">        {</div>
<div class="line">            x = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_X();</div>
<div class="line">            y = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_Y();</div>
<div class="line">            z = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_Z();</div>
<div class="line">            ESP_LOGW(<span class="stringliteral">&quot;Main&quot;</span>, <span class="stringliteral">&quot;Velocity: x: %.3f y: %.3f z: %.3f&quot;</span>, x, y, z);</div>
<div class="line"> </div>
<div class="line">            x = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#a7077b9a130f1dcf0192454e387968dd6">get_roll_deg</a>();</div>
<div class="line">            y = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#af50010400cbd1445e9ddfa259384b412">get_pitch_deg</a>();</div>
<div class="line">            z = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#af80f7795656e695e036d3b1557aed94c">get_yaw_deg</a>();</div>
<div class="line">            ESP_LOGI(<span class="stringliteral">&quot;Main&quot;</span>, <span class="stringliteral">&quot;Euler Angle: x (roll): %.3f y (pitch): %.3f z (yaw): %.3f&quot;</span>, x, y, z);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="a_b_n_o08x_8hpp_html"><div class="ttname"><a href="_b_n_o08x_8hpp.html">BNO08x.hpp</a></div></div>
<div class="ttc" id="a_callback_tests_8cpp_html_ac36e56130d5d806898f3545d4cdf0f70"><div class="ttname"><a href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a></div><div class="ttdeci">BNO08x * imu</div><div class="ttdef"><b>Definition</b> CallbackTests.cpp:20</div></div>
<div class="ttc" id="aclass_b_n_o08x_html"><div class="ttname"><a href="class_b_n_o08x.html">BNO08x</a></div><div class="ttdoc">BNO08x IMU driver class.</div><div class="ttdef"><b>Definition</b> BNO08x.hpp:34</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_a7077b9a130f1dcf0192454e387968dd6"><div class="ttname"><a href="class_b_n_o08x.html#a7077b9a130f1dcf0192454e387968dd6">BNO08x::get_roll_deg</a></div><div class="ttdeci">float get_roll_deg()</div><div class="ttdoc">Get the reported rotation about x axis.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:2942</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_ab56b185d6c9e972a2b28c2621387bb86"><div class="ttname"><a href="class_b_n_o08x.html#ab56b185d6c9e972a2b28c2621387bb86">BNO08x::data_available</a></div><div class="ttdeci">bool data_available(bool ignore_no_reports_enabled=false)</div><div class="ttdoc">Checks if BNO08x has asserted interrupt and sent data.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:1469</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_abe04c38b5bd52d331bd8aefae1f51947"><div class="ttname"><a href="class_b_n_o08x.html#abe04c38b5bd52d331bd8aefae1f51947">BNO08x::enable_game_rotation_vector</a></div><div class="ttdeci">void enable_game_rotation_vector(uint32_t time_between_reports)</div><div class="ttdoc">Sends command to enable game rotation vector reports (See Ref. Manual 6.5.19)</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:2223</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_aea8e2c6dd7a2c9899479a7f39fe94798"><div class="ttname"><a href="class_b_n_o08x.html#aea8e2c6dd7a2c9899479a7f39fe94798">BNO08x::initialize</a></div><div class="ttdeci">bool initialize()</div><div class="ttdoc">Initializes BNO08x sensor.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:74</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_af50010400cbd1445e9ddfa259384b412"><div class="ttname"><a href="class_b_n_o08x.html#af50010400cbd1445e9ddfa259384b412">BNO08x::get_pitch_deg</a></div><div class="ttdeci">float get_pitch_deg()</div><div class="ttdoc">Get the reported rotation about y axis.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:2952</div></div>
<div class="ttc" id="aclass_b_n_o08x_html_af80f7795656e695e036d3b1557aed94c"><div class="ttname"><a href="class_b_n_o08x.html#af80f7795656e695e036d3b1557aed94c">BNO08x::get_yaw_deg</a></div><div class="ttdeci">float get_yaw_deg()</div><div class="ttdoc">Get the reported rotation about z axis.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:2962</div></div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md7"></a>
Call-Back Function Example</h4>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_b_n_o08x_8hpp.html">BNO08x.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> app_main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_class" href="class_b_n_o08x.html">BNO08x</a> <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>; <span class="comment">// create IMU object with default wiring scheme</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// if a custom wiring scheme is desired instead of default:</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">    bno08x_config_t imu_config;     //create config struct</span></div>
<div class="line"><span class="comment">    imu_config.io_mosi = GPIO_NUM_X; //assign pin</span></div>
<div class="line"><span class="comment">    imu_config.io_miso = GPIO_NUM_X; //assign pin</span></div>
<div class="line"><span class="comment">    //etc...</span></div>
<div class="line"><span class="comment">    BNO08x imu(imu_config); //pass config to BNO08x constructor</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#aea8e2c6dd7a2c9899479a7f39fe94798">initialize</a>(); <span class="comment">// initialize IMU</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// enable gyro &amp; game rotation vector</span></div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#abe04c38b5bd52d331bd8aefae1f51947">enable_game_rotation_vector</a>(100000UL); <span class="comment">// 100,000us == 100ms report interval</span></div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.enable_gyro(150000UL);                 <span class="comment">// 150,000us == 150ms report interval</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// register a callback function (in this case a lambda function, but it doesn&#39;t have to be)</span></div>
<div class="line">    <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#a06bb0c70305421b5357e64f31579fdc7">register_cb</a>(</div>
<div class="line">        [&amp;<a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>]()</div>
<div class="line">        {</div>
<div class="line">            <span class="comment">// callback function contents, executed whenever new data is parsed</span></div>
<div class="line">            <span class="comment">// print absolute heading in degrees and angular velocity in Rad/s</span></div>
<div class="line">            <span class="keywordtype">float</span> x, y, z = 0;</div>
<div class="line">            x = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_X();</div>
<div class="line">            y = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_Y();</div>
<div class="line">            z = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.get_gyro_calibrated_velocity_Z();</div>
<div class="line">            ESP_LOGW(<span class="stringliteral">&quot;Main&quot;</span>, <span class="stringliteral">&quot;Velocity: x: %.3f y: %.3f z: %.3f&quot;</span>, x, y, z);</div>
<div class="line"> </div>
<div class="line">            x = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#a7077b9a130f1dcf0192454e387968dd6">get_roll_deg</a>();</div>
<div class="line">            y = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#af50010400cbd1445e9ddfa259384b412">get_pitch_deg</a>();</div>
<div class="line">            z = <a class="code hl_variable" href="_callback_tests_8cpp.html#ac36e56130d5d806898f3545d4cdf0f70">imu</a>.<a class="code hl_function" href="class_b_n_o08x.html#af80f7795656e695e036d3b1557aed94c">get_yaw_deg</a>();</div>
<div class="line">            ESP_LOGI(<span class="stringliteral">&quot;Main&quot;</span>, <span class="stringliteral">&quot;Euler Angle: x (roll): %.3f y (pitch): %.3f z (yaw): %.3f&quot;</span>, x, y, z);</div>
<div class="line">        });</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (1)</div>
<div class="line">    {</div>
<div class="line">        vTaskDelay(300 / portTICK_PERIOD_MS); <span class="comment">// delay here is irrelevant, we just don&#39;t want to trip cpu watchdog</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_b_n_o08x_html_a06bb0c70305421b5357e64f31579fdc7"><div class="ttname"><a href="class_b_n_o08x.html#a06bb0c70305421b5357e64f31579fdc7">BNO08x::register_cb</a></div><div class="ttdeci">void register_cb(std::function&lt; void()&gt; cb_fxn)</div><div class="ttdoc">Registers a callback to execute when new data from a report is received.</div><div class="ttdef"><b>Definition</b> BNO08x.cpp:1493</div></div>
</div><!-- fragment --> <p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Unit Tests</h2>
<p align="right">A basic unit testing suite is included with this library, but it is very rudimentary. <br  />
 It can be used to verify some of the basic features of a <a class="el" href="class_b_n_o08x.html" title="BNO08x IMU driver class.">BNO08x</a> device and this library. </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md9"></a>
Running Tests</h3>
<ol type="1">
<li>Create a project and add the component as described in the getting started guide.</li>
<li><p class="startli">Open the outermost CMakeLists.txt file in the project root directory, as depicted below. <br  />
</p>
<p class="startli"><img src="README_images/OutermostCMake.png" alt="image" class="inline"/></p>
</li>
<li><p class="startli">Modify the file by adding "set(TEST_COMPONENTS "esp32_BNO08x" CACHE STRING "Components to test.")" as depicted below: <br  />
</p>
<div class="fragment"><div class="line"># For more information about build system see</div>
<div class="line"># https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/build-system.html</div>
<div class="line"># The following five lines of boilerplate have to be in your project&#39;s</div>
<div class="line"># CMakeLists in this exact order for cmake to work correctly</div>
<div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line">add_compile_definitions(&quot;ESP32C3_IMU_CONFIG&quot;)</div>
<div class="line">set(TEST_COMPONENTS &quot;esp32_BNO08x&quot; CACHE STRING &quot;Components to test.&quot;)</div>
<div class="line">include($ENV{IDF_PATH}/tools/cmake/project.cmake)</div>
<div class="line">project(bno08x_update)</div>
</div><!-- fragment --></li>
<li><p class="startli">Include the test suite in your main file and launch into the test suite: <br  />
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_b_n_o08x_test_suite_8hpp.html">BNO08xTestSuite.hpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> <span class="keywordtype">void</span> app_main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="class_b_n_o08x_test_suite.html#ac12545fe311a98e9c0ae6fea77da95fd">BNO08xTestSuite::run_all_tests</a>(); </div>
<div class="line">}</div>
<div class="ttc" id="a_b_n_o08x_test_suite_8hpp_html"><div class="ttname"><a href="_b_n_o08x_test_suite_8hpp.html">BNO08xTestSuite.hpp</a></div></div>
<div class="ttc" id="aclass_b_n_o08x_test_suite_html_ac12545fe311a98e9c0ae6fea77da95fd"><div class="ttname"><a href="class_b_n_o08x_test_suite.html#ac12545fe311a98e9c0ae6fea77da95fd">BNO08xTestSuite::run_all_tests</a></div><div class="ttdeci">static void run_all_tests()</div><div class="ttdef"><b>Definition</b> BNO08xTestSuite.hpp:35</div></div>
</div><!-- fragment --></li>
<li>Ensure you run <code>idf.py fullclean</code> or delete your build directory before building for the first time after modifying the CMakeLists.txt file in step 3.</li>
</ol>
<p>(<a href="#readme-top">back to top</a>)</p>
<h3><a class="anchor" id="autotoc_md10"></a>
Adding Tests</h3>
<p>Tests are implemented with the <a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-guides/unit-tests.html">unity unit testing component</a>.</p>
<p>To add a test, create a new .cpp file, or modify one of the existing ones in <code>esp32_BNO08x/test/</code>. Follow the existing test structure as an example, use the <code><a class="el" href="_callback_tests_8cpp.html#ac18b9cb122499f587331d82a538f23aa">TEST_CASE()</a>{}</code> macro. <br  />
</p>
<p align="right">Any tests added will automatically be detected at build time. </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md11"></a>
Documentation</h2>
<p align="right">API documentation generated with doxygen can be found in the documentation directory of the master branch. <br  />
 </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Program Flowcharts</h2>
<p>The following charts illustrate the program flow this library implements for sending and receiving data from <a class="el" href="class_b_n_o08x.html" title="BNO08x IMU driver class.">BNO08x</a>. <br  />
 These are here to aid development for anyone looking to modify, fork, or contribute. <br  />
</p>
<p align="right"><img src="README_images/esp32_BNO08x_flowchart.png" alt="image" class="inline"/> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md13"></a>
Acknowledgements</h2>
<p>Special thanks to the original creators of the sparkfun BNO080 library. Developing this without a reference would have been much more time consuming. <br  />
 <a href="https://github.com/sparkfun/SparkFun_BNO080_Arduino_Library">https://github.com/sparkfun/SparkFun_BNO080_Arduino_Library</a> <br  />
</p>
<p>Special thanks to Anton Babiy, aka hwBirdy007 for helping with debugging SPI. <br  />
 <a href="https://github.com/hwBirdy007">https://github.com/hwBirdy007</a> <br  />
</p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md14"></a>
License</h2>
<p align="right">Distributed under the MIT License. See <code>LICENSE.md</code> for more information. </p>
<p>(<a href="#readme-top">back to top</a>)</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Contact</h2>
<p>Myles Parfeniuk - <a href="#" onclick="location.href='mai'+'lto:'+'myl'+'es'+'.pa'+'rf'+'eny'+'uk'+'@gm'+'ai'+'l.c'+'om'; return false;">myles<span class="obfuscator">.nosp@m.</span>.par<span class="obfuscator">.nosp@m.</span>fenyu<span class="obfuscator">.nosp@m.</span>k@gm<span class="obfuscator">.nosp@m.</span>ail.c<span class="obfuscator">.nosp@m.</span>om</a></p>
<p align="right">Project Link: <a href="https://github.com/myles-parfeniuk/esp32_BNO08x.git">https://github.com/myles-parfeniuk/esp32_BNO08x.git</a> </p>
<p>(<a href="#readme-top">back to top</a>)</p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0 </li>
  </ul>
</div>
</body>
</html>
